<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>jsTree test</title>
    <!-- 2 load the theme CSS file -->
    <script src="https://code.jquery.com/jquery-2.2.0.min.js"></script>
    <link rel="stylesheet" href="css/themes/default/style.min.css" />
</head>
<body>

<div id="jstree">

    <ul id="main">

    </ul>
</div>


<script>

    var _getAllFilesFromFolder = function(dir) {

        var filesystem = require("fs");
        var results = [[]];

        filesystem.readdirSync(dir).forEach(function(file) {
                var fullDir = dir + file;

                filesystem.stat(fullDir, function (err, stats) {
                    if(err){
                        console.log("File: " + file);
                    }
                    if(stats.isFile()){
                        results.push([file, "jstree-file", fullDir]);
                    }
                    else if(stats.isDirectory()){
                        results.push([file, "", fullDir]);
                        //console.log("fullDir: " + fullDir);
                        //_getAllFilesFromFolder(fullDir+"/");
                    }
                });




        });

        return results;

    };


    var results = _getAllFilesFromFolder("./");
    var $ = require("jquery");
    console.log(results);
    $(document).ready(function () {

        var jsonContent = [];

        for(i=1; i<results.length; i++){
            var obj = {text: results[i][0], icon: results[i][1], id: results[i][2]};
            jsonContent.push(obj);
        }

        console.log(jsonContent);
        $(function () {
            $('#jstree').jstree({
                core: {
                    data: jsonContent,
                    check_callback: true
                },
                plugins: ["dnd", "sort"]
            });

            $('#jstree').on("changed.jstree", function (e, data) {
                console.log(data.selected);
            });

        });

    })
</script>

<script src="js/jstree.min.js"></script>
</body>
</html>